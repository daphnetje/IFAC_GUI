<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Bootstrap core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <!-- Custom styles for this template -->
    <link href={{url_for('static', filename="daphne_theme.css")}} rel="stylesheet">
    <!-- font awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <title>Data Explorer</title>
</head>

<body>

{% include 'navbar.html' %}

<div class = "container">
    <br>
    <center> <h4> Individual Discrimination Analysis </h4> </center>
</div>

<center> <div class="container">
    <div class="indiv_instance_upperbox">
        <center> <h6> Instance #{{selected_index}}, {{prot_info}} with a Low Income </h6> </center>
    </div>
    <div class="indiv_instance_middlebox">
        <center> {{selected_instance_html}} </center>
    </div>
    <div class="indiv_instance_lowerbox">
        <center> disc_score = {{disc_score}} </center>
    </div>
</div> </center>

<br>
<br>

<div class="container yellow_highlight_box"> <center> <br> <b> Similar Protected Instances </b>
        <p class="monospace">{{pos_ratio_prot}}</p> </center> </div>
<!-- This is where table will be shown -->
<div class = "container tableFixHead">
<table class="table table-condensed" id="my-table">
    <tr>
      {% for column_name in column_names %}
        {% if column_name not in numerical_cols %}
            <th scope="col">{{column_name}}</th>
        {% endif %}
      {% endfor %}
    </tr>
  </thead>

  <tbody>
    {% for prot_result in closest_prot_results %}
        <tr>
            {% for column in column_names %}
                {% if column not in numerical_cols %}
                    {% if column == 'sex' or column == 'race' %}
                        <td>{{prot_result[column]}}</td>
                    {% elif column == 'income' and prot_result[column] == '>50K' %}
                        <td class="table_green_highlight">{{prot_result[column]}}</td>
                    {% elif prot_result[column] != selected_instance[column] %}
                        <td class="table_orange_highlight">{{prot_result[column]}}</td>
                    {% else %}
                        <td>{{prot_result[column]}}</td>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </tr>
    {% endfor %}
    </tbody>
  </table>
</div>


{% if closest_ref_results == 'None' %}
<div class = "container">
    <br>
    <h6> These are no sufficiently similar instances from the reference group</h6>
</div>

{% else %}
<div class="container yellow_highlight_box"> <center> <br> <b> Similar Unprotected Instances </b>
        <p class="monospace">{{pos_ratio_ref}}</p> </center> </div>

    <!-- This is where table will be shown -->
    <div class = "container tableFixHead">
    <table class="table table-condensed" id="my-table">
        <tr>
          {% for column_name in column_names %}
            {% if column_name not in numerical_cols %}
                <th scope="col">{{column_name}}</th>
            {% endif %}
          {% endfor %}
        </tr>
      </thead>

      <tbody>
        {% for ref_result in closest_ref_results %}
            <tr>
                {% for column in column_names %}
                    {% if column not in numerical_cols %}
                        {% if column == 'sex' or column == 'race' %}
                            <td>{{ref_result[column]}}</td>
                        {% elif column == 'income' and ref_result[column] == '>50K' %}
                            <td class="table_green_highlight">{{ref_result[column]}}</td>
                        {% elif ref_result[column] != selected_instance[column] %}
                            <td class="table_orange_highlight">{{ref_result[column]}}</td>
                        {% else %}
                            <td>{{ref_result[column]}}</td>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
{% endif %}

</body>